!function (t, i, u) { var l, s = "#color-squares-info"; function n(t, e) { if (e && 0 < e.length) for (var r = 0; r < e.length; r++)o = t, a = e[r], d = void 0, (d = u.getAttrValFromDom(s, "data-productbox-container-selector")) && (0 < (d = a.productElement.find(d)).find("ul.attribute-squares").length || d && a.productId && 0 < a.productId && (a = a.productId, (o = i(o).filter("ul[data-productId='" + a + "']")) && 0 < o.length && (i(d).append(o), i(d).addClass("active"), (a = i(".product-item").has("[data-productid=" + a + "]")).find(" .second-product-image").remove(), a.find(".product-box-attribute-square.preselected").click()))); var o, a, d } t.getColorSquares = function () { var e, r = (e = [], i(l).each(function () { var t = i(this).attr("data-productid"); t && 0 < t && (t = { productId: t, productElement: i(this) }, e.push(t)) }), e); if (r && 0 !== r.length) { for (var t = [], o = 0; o < r.length; o++) { var a = r[o]; a.hasOwnProperty("productId") && t.push(a.productId) } var d = { productIds: t }, c = u.getAttrValFromDom(s, "data-retrieve-color-squares-url"); i.ajax({ cache: !1, type: "POST", data: i.toJSON(d), contentType: "application/json; charset=utf-8", url: c }).done(function (t) { t && (n(t, r), i.event.trigger({ type: "colorSquaresLoadingCompleteEvent" })) }) } }, i(document).ready(function () { (l = u.getAttrValFromDom(s, "data-productbox-selector")) && t.getColorSquares() }), i(document).on("click", ".product-box-attribute-square", function () { var t, e, r, c = i(this), o = c.closest("li"); o.hasClass("selected-value") || (t = u.getAttrValFromDom("#color-squares-info", "data-product-attribute-change-url"), (e = c.closest(".product-item").data("productid")) && 0 < e && ((r = {})[c.attr("name")] = c.attr("value"), addAntiForgeryToken(r), i.ajax({ cache: !1, url: t + "?productId=" + e + "&validateAttributeConditions=true&loadpicture=true", data: r, type: "POST", success: function (t) { if (t.price && (e = u.getAttrValFromDom("#color-squares-info", "data-productbox-price-selector"), 0 < (e = c.closest(".product-item").find(e)).length && e.text(t.price)), t.pictureDefaultSizeUrl) { var e = c.closest(".product-item").find(".swiper"); if (0 < e.length) { for (var r = c.closest(".product-item").find(".swiper").find(".swiper-slide img"), o = 0, a = 0; a < r.length; a++) { var d = t.pictureFullSizeUrl.slice(0, -5); if (-1 !== r[a].src.indexOf(d)) { o = a; break } } e = e[0].swiper; e && e.slideTo(o) } else c.closest(".product-item").find(".picture img").attr("src", t.pictureDefaultSizeUrl) } } })), o.addClass("selected-value"), o.siblings(".selected-value").removeClass("selected-value")) }), i(document).on("nopAjaxFiltersFiltrationCompleteEvent newProductsAddedToPageEvent", t.getColorSquares) }(window.colorSquares = window.colorSquares || {}, jQuery, sevenSpikesCore);
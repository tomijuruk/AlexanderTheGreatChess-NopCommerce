function loadMapScript(){var e=document.createElement("script"),t=$("#customer-nop-address").attr("data-googleapikey").trim();e.src="https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=places&callback=initializeMap",t&&(e.src+="&key="+t),document.body.appendChild(e)}function getCustomMapStyles(){var e=$("#customer-nop-address").attr("data-mapstyles"),t="";if(!e)return t;try{t=JSON.parse(e)}catch(e){console.log("Invalid custom map styles value!")}return t}function initializeMap(){var e=document.getElementById(mapWrapperId),t={center:new google.maps.LatLng(40.713081,-74.006287),zoom:15,mapTypeId:google.maps.MapTypeId.ROADMAP,styles:getCustomMapStyles()};map=new google.maps.Map(e,t),google.maps.event.addListenerOnce(map,"idle",function(){placeMarkerByAvailableMethod(),createMapSearchBox()}),google.maps.event.addListener(map,"click",function(e){repositionMarker(e.latLng.lat(),e.latLng.lng())})}function addMarker(e,t,a,n){var o=$("#"+mapWrapperId).attr("data-pathtoimages")+"/footer-map-marker-icon.png",r=new google.maps.Marker({position:new google.maps.LatLng(e,t),map:map,title:a,icon:o,draggable:n});markers.push(r),r.setMap(map),map.setCenter(new google.maps.LatLng(e,t)),google.maps.event.addListener(r,"dragend",function(e){latitudeElement.val(e.latLng.lat()),longitudeElement.val(e.latLng.lng())})}function setMarkerByAddress(e){null!=e&&e.length>0&&$.ajax({cache:!1,type:"GET",url:"http://maps.google.com/maps/api/geocode/json?address="+e+"&sensor=false",success:function(e){e&&"ZERO_RESULTS"!=e.status&&e.results.length>0&&repositionMarker(e.results[0].geometry.location.lat,e.results[0].geometry.location.lng)}})}function placeMarkerByAvailableMethod(){addMarker("40.713081","-74.006287","Placed",!0);var e="0",t="0",a=new RegExp(/^-?\d+\.?\d*$/);if(latitudeElement.length>0&&longitudeElement.length>0&&latitudeElement.val().length>0&&longitudeElement.val().length>0&&a.test(latitudeElement.val().trim())&&a.test(longitudeElement.val().trim()))return e=latitudeElement.val().trim(),t=longitudeElement.val().trim(),void repositionMarker(e,t);if(navigator.geolocation)navigator.geolocation.getCurrentPosition(function(e){repositionMarker(e.coords.latitude,e.coords.longitude)});else{var n=$("#customer-nop-address");n.length>0&&n.val().length>0&&setMarkerByAddress(n.val())}}function repositionMarker(e,t){markers[0].setPosition(new google.maps.LatLng(e,t)),map.setCenter(new google.maps.LatLng(e,t)),latitudeElement.val(markers[0].position.lat()),longitudeElement.val(markers[0].position.lng())}function moveMarkerOnCoordinatesChange(){var e=latitudeElement.val(),t=longitudeElement.val(),a=new RegExp(/^-?\d+\.?\d*$/);e.length>0&&t.length>0&&a.test(e)&&a.test(t)&&(markers[0].setPosition(new google.maps.LatLng(e,t)),map.setCenter(new google.maps.LatLng(e,t)))}function setAllMap(e){for(var t=0;t<markers.length;t++)markers[t].setMap(e)}function clearMarkers(){setAllMap(null)}function showMarkers(){setAllMap(map)}function deleteMarkers(){clearMarkers(),markers=[]}function createMapSearchBox(){$("#shop-address-input").on("keyup keypress",function(e){if(13==e.which)return e.preventDefault(),!1});var e=document.getElementById("shop-address-input");map.controls[google.maps.ControlPosition.TOP_LEFT].push(e);var t=new google.maps.places.SearchBox(e);e.style.display="block",google.maps.event.addListener(t,"places_changed",function(){var e=t.getPlaces();0!=e.length&&(repositionMarker(e[0].geometry.location.lat(),e[0].geometry.location.lng()),map.setCenter(e[0].geometry.location))})}var mapWrapperId="chooseLocationMap",map,markers=[],latitudeElement,longitudeElement;$(document).ready(function(){$(".theme-color .adminData div").click(function(){$(".theme-color .adminData div").removeClass("active"),$(this).addClass("active");var e=$(".theme-color .adminData div input");$.each(e,function(e,t){t.removeAttribute("checked")}),$(this).find("input").attr("checked","checked")}),$(".radionButton input[checked]").parent().addClass("active"),$("#venture-settings-edit a[data-tab-name='tab-map-settings']").on("click",function(){setTimeout(function(){google.maps.event.trigger(map,"resize")})}),loadMapScript(),latitudeElement=$("#Latitude"),longitudeElement=$("#Longitude"),$(latitudeElement).on("change",moveMarkerOnCoordinatesChange),$(longitudeElement).on("change",moveMarkerOnCoordinatesChange)});